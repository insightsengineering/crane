% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gkm.R
\name{g_km}
\alias{g_km}
\title{Generate a Kaplan-Meier Plot with Annotations}
\usage{
g_km(
  fit_km,
  variables,
  coxph_tbl = NULL,
  control_surv = control_surv_timepoint(),
  col = NULL,
  lty = NULL,
  lwd = 0.5,
  censor_show = TRUE,
  pch = 3,
  size = 2,
  max_time = NULL,
  xticks = NULL,
  xlab = "Days",
  yval = c("Survival", "Failure"),
  ylab = paste(yval, "Probability"),
  ylim = NULL,
  title = NULL,
  footnotes = NULL,
  font_size = 10,
  ci_ribbon = FALSE,
  annot_at_risk = TRUE,
  annot_at_risk_title = TRUE,
  annot_surv_med = TRUE,
  control_annot_surv_med = control_surv_med_annot(),
  control_annot_coxph = control_coxph_annot(),
  legend_pos = NULL,
  rel_height_plot = 0.75,
  ggtheme = NULL,
  as_list = FALSE
)
}
\arguments{
\item{fit_km}{A fitted Kaplan-Meier object of class \code{survfit}, typically
generated by \code{\link{h_km_fit}}.}

\item{variables}{A named list specifying the survival and grouping variables (needed
for accessing the column names, even if the fit is provided).}

\item{coxph_tbl}{An optional data frame containing pre-calculated Cox-PH results,
typically generated by \code{\link{h_tbl_coxph_pairwise}}. If provided, a Cox-PH annotation table is added.}

\item{control_surv}{A list of control parameters for the survival model, from \code{\link{control_surv_timepoint}}.}

\item{col}{A character vector of colors for the survival curves. Length should match number of arms.}

\item{lty}{A vector of line types for the survival curves, or \code{NULL} for default.}

\item{lwd}{Numeric value specifying line width for the survival curves.}

\item{censor_show}{Logical, whether to display censoring marks on the plot.}

\item{pch}{Plotting character for censoring marks.}

\item{size}{Size of the censoring marks.}

\item{max_time}{Numeric, the maximum time point to display on the x-axis.}

\item{xticks}{Numeric vector of x-axis tick positions, or a single number for the interval, or \code{NULL} for auto.}

\item{xlab}{Character string for the x-axis label.}

\item{yval}{Character string, either \code{"Survival"} or \code{"Failure"} to plot Survival or Failure probability.}

\item{ylab}{Character string for the y-axis label.}

\item{ylim}{Numeric vector of length 2 for y-axis limits.}

\item{title}{Character string for the plot title.}

\item{footnotes}{Character string for plot footnotes/caption.}

\item{font_size}{Numeric, base font size for the plot theme.}

\item{ci_ribbon}{Logical, whether to display confidence intervals as a ribbon (area).}

\item{annot_at_risk}{Logical, whether to include the 'Numbers at Risk' table below the plot.}

\item{annot_at_risk_title}{Logical, whether to include the title "Patients at Risk:" in the table.}

\item{annot_surv_med}{Logical, whether to include the median survival time annotation table.}

\item{control_annot_surv_med}{A list of control parameters for the median survival annotation box,
typically generated by \code{\link{control_surv_med_annot}}.}

\item{control_annot_coxph}{A list of control parameters for the Cox-PH annotation box,
typically generated by \code{\link{control_coxph_annot}}.}

\item{legend_pos}{Numeric vector of length 2 for legend position (x, y) relative to the plot area (0 to 1), or \code{NULL} for auto-placement.}

\item{rel_height_plot}{Numeric, relative height of the main plot area compared to the 'at-risk' table (0 to 1).}

\item{ggtheme}{An optional \code{ggplot2} theme to apply.}

\item{as_list}{Logical, if \code{TRUE}, returns a list containing the plot and the 'at-risk' table as separate \code{cowplot} objects; otherwise returns the combined \code{cowplot} object.}
}
\value{
A \code{cowplot} object combining the KM plot and the 'Numbers at Risk' table, or a list if \code{as_list = TRUE}.
}
\description{
This function creates a comprehensive ggplot2 object for a Kaplan-Meier
survival curve, optionally including annotations for median survival and Cox-PH results,
and a 'Numbers at Risk' table below the main plot.
}
